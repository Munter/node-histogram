!function(){var a,o,e=function(e,h){if(-1===["string","object"].indexOf(typeof e))throw new TypeError("Expected imageBuffer to be a string or a buffer");if("function"!=typeof h)throw new TypeError("Expected callback to be a function");var r,n,t;r=e,n=function(e,r){if(e)return h(e);var n,t,a,o,i,l={red:new Array(256),green:new Array(256),blue:new Array(256),alpha:new Array(256),colors:{rgb:0,rgba:0},palettes:{rgb:[],rgba:[]},greyscale:!0,alphachannel:!1},g={},c={};for(i=0;i<256;i+=1)l.red[i]=l.green[i]=l.blue[i]=l.alpha[i]=0;for(i=0;i<r.length;i+=4){n=r[i],t=r[i+1],a=r[i+2],(o=r[i+3])<255&&(l.alphachannel=!0),(l.greyscale&&n!==t||n!==a)&&(l.greyscale=!1),l.red[n]+=1,l.green[t]+=1,l.blue[a]+=1,l.alpha[o]+=1;var u=(16777216*n+65536*t+256*a+o).toString(16),s="#"+"0000000".substr(0,8-u.length)+u,f=s.substr(0,7);f in g?g[f]+=1:(g[f]=1,l.palettes.rgb.push(f),l.colors.rgb+=1),s in c?c[s]+=1:(c[s]=1,l.palettes.rgba.push(s),l.colors.rgba+=1)}h(null,l)},(t=new o).crossOrigin="Anonymous",t.onerror=function(){n(new Error("error while reading from input stream"))},t.onload=function(){var e=new a(t.width,t.height).getContext("2d");e.drawImage(t,0,0),n(null,e.getImageData(0,0,t.width,t.height).data)},t.src=r};if("object"==typeof exports){var r=require("canvas-prebuilt");a=r.Canvas,o=r.Image,module.exports=e}else a=function(e,r){var n=document.createElement("canvas");return n.width=e,n.height=r,n},o=window.Image,"function"==typeof define?define([],function(){return e}):window&&(window.histogram=e)}();
