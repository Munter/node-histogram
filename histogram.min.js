(function(){var a,b=function(b,c){var d=new a.Image;d.onerror=c,d.onload=function(){var b=(new a(d.width,d.height)).getContext("2d");b.drawImage(d,0,0),c(null,b.getImageData(0,0,d.width,d.height).data)},d.src=b},c=function(a,c){b(a,function(a,b){if(a)return c(a);var d={red:new Array(256),green:new Array(256),blue:new Array(256),alpha:new Array(256),colors:{rgb:0,rgba:0},palettes:{rgb:[],rgba:[]},greyscale:!0,alphachannel:!1},e,f,g,h,i={},j={},k;for(k=0;k<256;k+=1)d.red[k]=d.green[k]=d.blue[k]=d.alpha[k]=0;for(k=0;k<b.length;k+=4){e=b[k],f=b[k+1],g=b[k+2],h=b[k+3],h<255&&(d.alphachannel=!0);if(d.greyscale&&e!==f||e!==g)d.greyscale=!1;d.red[e]+=1,d.green[f]+=1,d.blue[g]+=1,d.alpha[h]+=1;var l=(e*16777216+f*65536+g*256+h).toString(16),m="#"+"0000000".substr(0,8-l.length)+l,n=m.substr(0,7);n in i?i[n]+=1:(i[n]=1,d.palettes.rgb.push(n),d.colors.rgb+=1),m in j?j[m]+=1:(j[m]=1,d.palettes.rgba.push(m),d.colors.rgba+=1)}c(null,d)})};typeof module!="undefined"?(a=require("canvas"),module.exports=c):(a=function(a,b){var c=document.createElement("canvas");return c.width=a,c.height=b,c},a.Image=Image,typeof define=="function"?define([],function(){return c}):window&&(window.histogram=c))})();