!function(){var e,r=function(r,n){var t=new e.Image;t.onerror=function(){n(new Error("error while reading from input stream"))},t.onload=function(){var r=new e(t.width,t.height).getContext("2d");r.drawImage(t,0,0),n(null,r.getImageData(0,0,t.width,t.height).data)},t.src=r},n=function(e,n){if(-1===["string","object"].indexOf(typeof e))throw new TypeError("Expected imageBuffer to be a string or a buffer");if("function"!=typeof n)throw new TypeError("Expected callback to be a function");r(e,function(e,r){if(e)return n(e);var t,a,o,i,g,l={red:new Array(256),green:new Array(256),blue:new Array(256),alpha:new Array(256),colors:{rgb:0,rgba:0},palettes:{rgb:[],rgba:[]},greyscale:!0,alphachannel:!1},c={},u={};for(g=0;256>g;g+=1)l.red[g]=l.green[g]=l.blue[g]=l.alpha[g]=0;for(g=0;g<r.length;g+=4){t=r[g],a=r[g+1],o=r[g+2],i=r[g+3],255>i&&(l.alphachannel=!0),(l.greyscale&&t!==a||t!==o)&&(l.greyscale=!1),l.red[t]+=1,l.green[a]+=1,l.blue[o]+=1,l.alpha[i]+=1;var f=(16777216*t+65536*a+256*o+i).toString(16),h="#"+"0000000".substr(0,8-f.length)+f,s=h.substr(0,7);s in c?c[s]+=1:(c[s]=1,l.palettes.rgb.push(s),l.colors.rgb+=1),h in u?u[h]+=1:(u[h]=1,l.palettes.rgba.push(h),l.colors.rgba+=1)}n(null,l)})};"object"==typeof exports?(e=require("canvas"),module.exports=n):(e=function(e,r){var n=document.createElement("canvas");return n.width=e,n.height=r,n},e.Image=Image,"function"==typeof define?define([],function(){return n}):window&&(window.histogram=n))}();